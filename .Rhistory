#  write_csv("unpacked_plant_data.csv")
#df
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
#for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
#censored_df = data.frame(Trial.Name = y1,
#                         Ecotype = y2,
#                         First.Infection = y3)
#censored_df <- censored_df %>% mutate(Censored = 1)
#df <- rbind(df, censored_df) %>%
#  write_csv("unpacked_plant_data.csv")
#df
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("unpacked_plant_data.csv")
df
ggplot(data = Sizes_df, aes(x = Size.Type, y=Sample.Size, color = Trial)) +
geom_point() +
facet_wrap(~Ecotype)
# Clear the environment
rm(list = ls())
#gc(reset = TRUE, verbose = FALSE)
# Notebook Settings
knitr::opts_chunk$set(echo = FALSE)
# Load Libraries
library(tidyverse)
library(tufte)
library(cowplot)
library(readxl)
#ggplot2 settings
theme_set(theme_cowplot())
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
# Clear the environment
rm(list = ls())
#gc(reset = TRUE, verbose = FALSE)
# Notebook Settings
knitr::opts_chunk$set(echo = FALSE)
# Load Libraries
library(tidyverse)
library(tufte)
library(cowplot)
library(readxl)
#ggplot2 settings
theme_set(theme_cowplot())
# Load data and cache a csv snapshot of the excel files
# Load cdf data
tidyplants_cdf <- read_excel("tidyplants.xlsx", sheet = "Survival_cdf.Data") %>%
gather(3:9, key = "Ecotype", value = "Total.Infections")
# Load sample size/number of censored-uncensored data
sampleSizes_df <- read_excel("tidyplants.xlsx", sheet = "Survival.Sample.Sizes")
# merger dataframes and store in .csv file
tidyplants_cdf <- merge(tidyplants_cdf, sampleSizes_df, by = c("Trial.Name", "Ecotype")) %>%
write_csv("tidyplants_cdf")
# display
knitr::kable(tidyplants_cdf %>% head)
cdf_plots <- ggplot(data = tidyplants_cdf, aes(x = Day, y = Total.Infections)) +
geom_point(color = "DodgerBlue4") +
geom_line(color = "Black") +
facet_grid(Trial.Name ~ Ecotype)
cdf_plots
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("unpacked_plant_data.csv")
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram() +
facet_grid(Trial.Name ~ Ecotype)
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("unpacked_plant_data.csv")
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram() +
facet_grid(Trial.Name ~ Ecotype)
knitr::kable(head(df))
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("unpacked_plant_data.csv")
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram(binwidth = 1, color = "Black", fill = "DodgerBlue4") +
facet_grid(Trial.Name ~ Ecotype)
knitr::kable(head(df))
newinfections_plot
# Clear the environment
rm(list = ls())
#gc(reset = TRUE, verbose = FALSE)
# Notebook Settings
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(tufte)
library(cowplot)
library(fastDummies)
library(survival)
library(survminer)
#ggplot2 settings
theme_set(theme_cowplot())
# Load data about new.infections pdf from csv file
raw_df <- read.csv("unpacked_plant_data.csv")
raw_cdf <- read.csv("tidyplants_cdf.csv")
# Take the Ecotype Variable and separate it out into separate covariate columns
df <- dummy_columns(raw_df, select_columns = c("Ecotype"))
# In general we will assumed censored plants do not show symptoms
# This is an assumption, that we should evaluate the liklihood of it being true, given our fit
uncensored_df <- df %>%
filter(Censored == 0)
# Plot data in 2D grid of histograms - Trial vs Ecotype
real_hist <- ggplot(data = uncensored_df, aes(First.Infection)) +
geom_histogram(binwidth = 1, color = "Black", fill = "DodgerBlue4") +
facet_grid(Trial.Name ~ Ecotype)
real_hist
head(raw_df)
cumulative_df <- raw_cdf
cumulative_df
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
# Clear the environment
rm(list = ls())
#gc(reset = TRUE, verbose = FALSE)
# Notebook Settings
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(tufte)
library(cowplot)
library(fastDummies)
library(survival)
library(survminer)
#ggplot2 settings
theme_set(theme_cowplot())
# Load data and cache a csv snapshot of the excel files
# Load cdf data
tidyplants_cdf <- read_excel("tidyplants.xlsx", sheet = "Survival_cdf.Data") %>%
gather(3:9, key = "Ecotype", value = "Total.Infections")
# Load sample size/number of censored-uncensored data
sampleSizes_df <- read_excel("tidyplants.xlsx", sheet = "Survival.Sample.Sizes") %>%
write_csv("tidyplants_sampleSizes.csv")
# merger dataframes and store in .csv file
tidyplants_cdf <- merge(tidyplants_cdf, sampleSizes_df, by = c("Trial.Name", "Ecotype")) %>%
write_csv("tidyplants_cdf.csv")
# display
knitr::kable(tidyplants_cdf %>% head)
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("unpacked_plant_data.csv")
df <- merge(df, sampleSizes_df, by = c("Trial.Name", "Ecotype"))
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram(binwidth = 1, color = "Black", fill = "DodgerBlue4") +
facet_grid(Trial.Name ~ Ecotype)
knitr::kable(head(df))
newinfections_plot
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("tidyplants.csv")
df <- merge(df, sampleSizes_df, by = c("Trial.Name", "Ecotype"))
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram(binwidth = 1, color = "Black", fill = "DodgerBlue4") +
facet_grid(Trial.Name ~ Ecotype)
knitr::kable(head(df))
newinfections_plot
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df) %>%
write_csv("tidyplants.csv")
df <- merge(df, sampleSizes_df, by = c("Trial.Name", "Ecotype"))
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram(binwidth = 1, color = "Black", fill = "DodgerBlue4") +
facet_grid(Trial.Name ~ Ecotype)
df
newinfections_plot
Sizes_df <- sampleSizes_df %>%
gather("Ncens", "Nobs", "Ntot",
key = Size.Type,
value = Sample.Size)
tidyplants_pdf <- tidyplants_cdf %>%
mutate(New.Infections = ifelse(Total.Infections == 0, 0, Total.Infections - lag(Total.Infections))) %>%
filter(New.Infections !=0)
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(tidyplants_pdf)){
y1 <- c(y1, rep(tidyplants_pdf$Trial[i], each = tidyplants_pdf$New.Infections[i]) )
y2 <- c(y2, rep(tidyplants_pdf$Ecotype[i], each = tidyplants_pdf$New.Infections[i]) )
y3 <- c(y3, rep(tidyplants_pdf$Day[i], each = tidyplants_pdf$New.Infections[i]) )
}
df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
df <- df %>% mutate(Censored = 0)
# Add in censored data
y1 <- c()
y2 <- c()
y3 <- c()
for(i in 1:nrow(sampleSizes_df)){
y1 <- c(y1, rep(sampleSizes_df$Trial.Name[i], each = sampleSizes_df$Ncens[i]))
y2 <- c(y2, rep(sampleSizes_df$Ecotype[i], each = sampleSizes_df$Ncens[i]))
y3 <- c(y3, rep(sampleSizes_df$ycens[i], each = sampleSizes_df$Ncens[i]))
}
censored_df = data.frame(Trial.Name = y1,
Ecotype = y2,
First.Infection = y3)
censored_df <- censored_df %>% mutate(Censored = 1)
df <- rbind(df, censored_df)
df <- merge(df, sampleSizes_df, by = c("Trial.Name", "Ecotype")) %>%
write_csv("tidyplants.csv")
newinfections_plot <- ggplot(data = df%>%filter(Censored == 0), aes(First.Infection)) +
geom_histogram(binwidth = 1, color = "Black", fill = "DodgerBlue4") +
facet_grid(Trial.Name ~ Ecotype)
newinfections_plot
